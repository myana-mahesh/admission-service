<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/htmml-headers :: common_head"></head>
<body>
<div class="container my-4">
  <div class="app-card">
    <form id="admissionForm" method="post" action="/admissions" enctype="multipart/form-data">
      <div class="row align-items-center mb-3">
        <div class="col-md-2 text-center"><div class="fw-bold text-muted">ABS Logo</div></div>
        <div class="col-md-7">
          <h4 class="mb-0">ABS EDUCATIONAL SOLUTION</h4>
          <small class="text-muted">Authorized Admission Centre · +91 98332 11999</small>
        </div>
        <div class="col-md-3"><div class="photo-box">Attach passport photo</div></div>
      </div>
      <div class="row g-3 mb-3">
        <div class="col-md-4"><label class="form-label">Form No.</label><input class="form-control" name="formNo" id="formNo"></div>
        <div class="col-md-4"><label class="form-label">Date</label><input type="date" class="form-control" name="formDate" id="formDate"></div>
        <div class="col-md-4"><label class="form-label">ABS ID</label><input class="form-control" name="absId" id="absId"></div>
      </div>

      <h5 class="mb-2">Student Details</h5>
      <div class="row g-3 mb-2">
        <div class="col-md-6"><label class="form-label">Student's Name</label><input class="form-control" name="studentName" id="studentName" required></div>
        <div class="col-md-3"><label class="form-label">Date of Birth</label><input type="date" class="form-control" name="dob" id="dob" required></div>
        <div class="col-md-3"><label class="form-label">Aadhaar No.</label><input class="form-control" name="aadhaar" id="aadhaar" pattern="\d{12}"></div>
        <div class="col-md-6"><label class="form-label">Father's Name</label><input class="form-control" name="fatherName" id="fatherName"></div>
        <div class="col-md-3"><label class="form-label">Father's Mobile</label><input class="form-control" name="fatherMobile" id="fatherMobile"></div>
        <div class="col-md-6"><label class="form-label">Mother's Name</label><input class="form-control" name="motherName" id="motherName"></div>
        <div class="col-md-3"><label class="form-label">Mother's Mobile</label><input class="form-control" name="motherMobile" id="motherMobile"></div>
        <div class="col-md-3"><label class="form-label">Nationality</label><input class="form-control" name="nationality" id="nationality"></div>
        <div class="col-md-3"><label class="form-label">Religion</label><input class="form-control" name="religion" id="religion"></div>
        <div class="col-md-3"><label class="form-label">Gender</label>
          <select class="form-select" name="gender" id="gender">
            <option th:each="g : ${genders}" th:value="${g}" th:text="${g}"></option>
          </select>
        </div>
        <div class="col-md-3"><label class="form-label">Caste</label>
          <select class="form-select" name="casteId" id="casteId">
            <option value="">Select Caste</option>
            <th:block th:each="c : ${castes}">
              <option th:value="${c.casteId}" th:text="${c.casteName}"></option>
            </th:block>
          </select>
        </div>
        <div class="col-md-6"><label class="form-label">Last College Attended</label><input class="form-control" name="lastCollege" id="lastCollege"></div>
        <div class="col-12"><label class="form-label">Residential Address</label><textarea class="form-control" name="address" id="address" rows="2"></textarea></div>
        <div class="col-md-3"><label class="form-label">PIN Code</label><input class="form-control" name="pincode" id="pincode" pattern="\d{6}"></div>
        <div class="col-md-4"><label class="form-label">Student Mobile No.</label><input class="form-control" name="studentMobile" id="studentMobile"></div>
        <div class="col-md-5"><label class="form-label">Email</label><input type="email" class="form-control" name="email" id="email"></div>
      </div>

      <h5 class="mt-3">For Office Use Only</h5>
      <div class="row g-3 mb-2">
        <div class="col-md-6"><label class="form-label">Selected Course</label>
          <select class="form-select" name="courseId" id="course">
            <option value="">Select Course</option>
            <th:block th:each="c : ${courses}">
              <option th:value="${c.courseId}" th:text="${c.courseName}"></option>
            </th:block>
          </select>
        </div>
        <div class="col-md-6"><label class="form-label">Date of Admission</label><input type="date" class="form-control" name="dateOfAdmission" id="doa"></div>
        <div class="col-md-6"><label class="form-label">Attended College Name</label><input class="form-control" name="attendedCollege" id="attendedCollege"></div>
        <div class="col-md-6"><label class="form-label">College Location</label><input class="form-control" name="collegeLocation" id="collegeLocation"></div>
        <div class="col-12"><label class="form-label">Remarks</label><input class="form-control" name="remarks" id="remarks"></div>
      </div>

      <h5 class="mt-3">Documents</h5>
      <div class="row g-2 mb-2">
        <th:block th:each="doc : ${documentTypes}">
          <div class="col-md-3 form-check form-switch">
            <input class="form-check-input" type="checkbox" th:id="${'doc_'+doc.documentTypeId}" th:name="${'doc_'+doc.code}" />
            <label class="form-check-label" th:for="${'doc_'+doc.documentTypeId}" th:text="${doc.name}"></label>
          </div>
        </th:block>
      </div>

      <h5 class="mt-3">Fees & Installments</h5>
      <div class="mb-2">
        <button type="button" class="btn btn-sm btn-outline-primary" id="addInstBtn">Add Installment</button>
        <div class="help text-muted small">Add as many installments as required; use Year & Installment No.</div>
      </div>
      <table class="table table-bordered" id="feesTable">
        <thead class="table-light"><tr><th>Study Year</th><th>Installment No</th><th>Amount (₹)</th><th>Due Date</th><th></th></tr></thead>
        <tbody></tbody>
      </table>

      <h5 class="mt-3">Upload Documents</h5>
      <div class="row g-3 mb-3">
        <div class="col-md-6"><label class="form-label">10th Marksheet</label><input type="file" class="form-control" name="file_10th" data-doc-code="SSC"></div>
        <div class="col-md-6"><label class="form-label">12th Marksheet</label><input type="file" class="form-control" name="file_12th" data-doc-code="HSC"></div>
        <div class="col-md-6"><label class="form-label">L.C / T.C</label><input type="file" class="form-control" name="file_lc" data-doc-code="LC_TC"></div>
        <div class="col-md-6"><label class="form-label">Migration</label><input type="file" class="form-control" name="file_mig" data-doc-code="MIG"></div>
        <div class="col-md-6"><label class="form-label">Aadhaar Card</label><input type="file" class="form-control" name="file_aadhaar" data-doc-code="AADHAAR"></div>
        <div class="col-md-6"><label class="form-label">Passport Photo</label><input type="file" class="form-control" name="file_photo" data-doc-code="PHOTO"></div>
      </div>

      <h5 class="mt-3">Declaration</h5>
      <div class="mb-3"><textarea class="form-control" rows="3" readonly>I, __________________, hereby declare... </textarea></div>

      <div class="row g-3 mt-3">
        <div class="col-md-4"><div class="sig">Student Signature</div></div>
        <div class="col-md-4"><div class="sig">Parent Signature</div></div>
        <div class="col-md-4"><div class="sig">Counsellor</div></div>
      </div>

      <div class="d-flex justify-content-end mt-4">
        <button type="submit" class="btn btn-primary">Submit</button>
      </div>

    </form>
  </div>
</div>

<script src="/static/js/admission-form.js"></script>
<script src="/static/js/feesmanagement.js"></script>
<script>
  (function(){
    const tbody = document.querySelector('#feesTable tbody');
    document.getElementById('addInstBtn').addEventListener('click', ()=>{
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><input name="studyYear" class="form-control" type="number" min="1" value="1"></td>
        <td><input name="installmentNo" class="form-control" type="number" min="1" value="1"></td>
        <td><input name="amount" class="form-control" type="number" step="0.01"></td>
        <td><input name="dueDate" class="form-control" type="date"></td>
        <td><button type="button" class="btn btn-sm btn-danger remove">Remove</button></td>`;
      tbody.appendChild(row);
      row.querySelector('.remove').addEventListener('click', ()=> row.remove());
    });
  })();
</script>

</body>
</html>
